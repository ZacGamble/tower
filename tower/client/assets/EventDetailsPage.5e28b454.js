import{u as z,q as J,A as U,c as v,a as O,o as r,b as m,d as e,G as V,w as _,v as f,t as l,n as F,F as P,D as G,x as W,y as Y,E as M}from"./vendor.586f66d3.js";import{_ as H,A as c,P as i,b as K,t as d,l as E,c as Q}from"./index.31fb735e.js";const X={setup(){const o=z(),a=J({eventId:o.params.eventId});return U(async()=>{try{await d.getActiveEvent(o.params.eventId),await d.getCommentsByEvent(o.params.eventId),await d.getTicketsByEvent(o.params.eventId)}catch(n){E.error(n)}}),{comment:a,activeEvent:v(()=>c.activeEvent),activeComments:v(()=>c.activeComments),activeTickets:v(()=>c.activeTickets),myTicketsForEvent:v(()=>c.activeTickets.find(n=>n.eventId==c.activeEvent.id)),account:v(()=>c.account),async createTicket(){try{if(c.activeEvent.capacity==0||c.activeEvent.isCanceled){i.toast("This event is now unavailable");return}if(c.activeTickets.find(n=>n.accountId===this.account.id)){i.toast("You already have a ticket","info");return}await K.createTicket(o.params.eventId),c.activeEvent.capacity--,await d.getTicketsByEvent(o.params.eventId),i.toast("Ticket generation success","success")}catch(n){E.error(n),i.toast(n.message,"error")}},async submitComment(){try{await Q.createComment(a.value),await d.getActiveEvent(o.params.eventId)}catch(n){E.error(n),i.toast(n.message,"error")}},async cancelEvent(){try{await i.confirm()&&(await d.cancelEvent(o.params.eventId),i.toast("event canceled"))}catch(n){E.error(n),i.toast(n.message,"error")}}}}},Z={class:"container-fluid"},$={class:"row bg-light text-dark"},ee=["src"],te={class:"fs-1"},ne={class:"col-md-8 p-4"},ae={class:"d-flex justify-content-between"},se={class:"fs-6 fw-bold"},ce={class:"d-flex justify-content-between"},oe={class:"d-flex justify-content-between my-4"},ie={key:0},re={class:"text-dark"},le=F(" spots left"),de={key:1},ve=e("b",{class:"text-dark"},"NO SPOTS LEFT",-1),me=[ve],_e=["title"],Ee=e("i",{class:"mdi mdi-account"},null,-1),fe={class:"row"},ye={class:"col-md-12"},he=e("small",null,"See who is attending",-1),be={class:"row"},ue={class:"col-md-12 px-5 bg-secondary"},ge=e("small",null,"What are people saying",-1),pe=e("div",{class:"d-flex justify-content-end"},[e("small",null,"Join the conversation")],-1),ke=e("div",{class:"d-flex justify-content-end"},[e("button",{class:"btn btn-success mt-4",type:"submit",title:"submit comment"}," post comment ")],-1);function we(o,a,n,t,Ce,xe){var y,h,b,u,g,p,k,w,C,x,T,I,A,S,B,j,N,D,L;const R=O("Attendees"),q=O("Comment");return r(),m("div",Z,[e("div",$,[e("div",{class:V(["col-md-4 p-4",((y=t.activeEvent)==null?void 0:y.capacity)<=0||((h=t.activeEvent)==null?void 0:h.isCanceled)?"bg-danger":"bg-light"])},[e("img",{src:(b=t.activeEvent)==null?void 0:b.coverImg,alt:"cover image",class:"img-fluid"},null,8,ee),_(e("button",{onClick:a[0]||(a[0]=s=>t.cancelEvent()),type:"button",title:"cancel event",class:"btn btn-danger mt-3"}," Cancel event? ",512),[[f,((u=t.account)==null?void 0:u.id)==((g=t.activeEvent)==null?void 0:g.creatorId)&&((p=t.activeEvent)==null?void 0:p.isCanceled)==!1]]),_(e("span",te,"EVENT NO LONGER AVAILABLE",512),[[f,((k=t.activeEvent)==null?void 0:k.capacity)<=0||((w=t.activeEvent)==null?void 0:w.isCanceled)]])],2),e("div",ne,[e("div",ae,[e("h4",null,l((C=t.activeEvent)==null?void 0:C.name),1),e("p",se," On "+l((x=t.activeEvent)==null?void 0:x.startDate.substring(5,10)),1)]),e("div",ce,[e("h6",null,l((T=t.activeEvent)==null?void 0:T.location),1)]),e("p",null,l((I=t.activeEvent)==null?void 0:I.description),1),e("div",oe,[((A=t.activeEvent)==null?void 0:A.capacity)>0?(r(),m("span",ie,[e("b",re,l((S=t.activeEvent)==null?void 0:S.capacity),1),le])):(r(),m("span",de,me)),_(e("span",null,[e("button",{onClick:a[1]||(a[1]=s=>t.createTicket()),title:"attend "+((B=t.activeEvent)==null?void 0:B.type),class:V([((j=t.activeEvent)==null?void 0:j.capacity)<=0||((N=t.activeEvent)==null?void 0:N.isCanceled)?"btn btn-danger":"","btn btn-warning"])},[F(" Attend "+l((D=t.activeEvent)==null?void 0:D.type)+" ",1),Ee],10,_e)],512),[[f,!((L=t.activeEvent)==null?void 0:L.isCanceled)]])])])]),e("div",fe,[e("div",ye,[he,(r(!0),m(P,null,G(t.activeTickets,s=>(r(),M(R,{key:s.id,attendee:s},null,8,["attendee"]))),128))])]),e("div",be,[e("div",ue,[ge,e("form",{class:"d-flex flex-column border border-dark p-3 rounded",onSubmit:a[3]||(a[3]=W(s=>t.submitComment(),["prevent"]))},[pe,_(e("textarea",{class:"bg-grey",name:"comment-field",id:"comment-field",title:"leave a comment",placeholder:"Tell the people...","onUpdate:modelValue":a[2]||(a[2]=s=>t.comment.body=s)},null,512),[[Y,t.comment.body]]),ke],32),(r(!0),m(P,null,G(t.activeComments,s=>(r(),M(q,{key:s.id,comment:s},null,8,["comment"]))),128))])])])}var Ae=H(X,[["render",we]]);export{Ae as default};
